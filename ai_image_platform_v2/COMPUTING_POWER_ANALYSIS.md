# AIå›¾åƒå¤„ç†å¹³å° - ç®—åŠ›éœ€æ±‚åˆ†ææŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šåˆ†æäº†AIå›¾åƒå¤„ç†å¹³å°çš„**æœ¬åœ°è®¡ç®—ç®—åŠ›éœ€æ±‚**ï¼Œè§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦å¤§ç®—åŠ›çš„åŸå› ï¼Œå¹¶æä¾›äº†è¯¦ç»†çš„ç¡¬ä»¶é…ç½®å»ºè®®ã€‚å¹³å°ä¸»è¦ç®—åŠ›æ¶ˆè€—é›†ä¸­åœ¨**æœ¬åœ°OpenCVå›¾åƒå¤„ç†**å’Œ**rembgæ·±åº¦å­¦ä¹ æ¨¡å‹æ¨ç†**ä¸Šï¼Œè€Œéå¤–éƒ¨APIè°ƒç”¨ã€‚

## ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å¤§ç®—åŠ›ï¼Ÿ

### **æ ¸å¿ƒåŸå› åˆ†æ**

#### 1. **æœ¬åœ°æ·±åº¦å­¦ä¹ æ¨¡å‹æ¨ç†**
```python
# èƒŒæ™¯ç§»é™¤ä½¿ç”¨æœ¬åœ°rembg + u2netæ¨¡å‹
from rembg import remove, new_session
session = new_session('u2net')  # åŠ è½½æ·±åº¦å­¦ä¹ æ¨¡å‹
output = remove(pil_img, session=session)  # æœ¬åœ°æ¨ç†
```
**ç®—åŠ›éœ€æ±‚**: 
- **æ¨¡å‹åŠ è½½**: u2netæ¨¡å‹çº¦150MBï¼Œéœ€è¦GPUæ˜¾å­˜
- **æ¨ç†è®¡ç®—**: æ¯å¼ å›¾ç‰‡éœ€è¦å¤§é‡çŸ©é˜µè¿ç®—
- **å†…å­˜å ç”¨**: æ¨¡å‹ + å›¾ç‰‡ç¼“å­˜éœ€è¦2-4GBå†…å­˜

#### 2. **OpenCVå®æ—¶å›¾åƒå¤„ç†**
```python
# AIç¾é¢œçš„å¤æ‚ç®—æ³•é“¾
- äººè„¸æ£€æµ‹: Haarçº§è”åˆ†ç±»å™¨ (CPUå¯†é›†å‹)
- å¤šå±‚ç£¨çš®: åŒè¾¹æ»¤æ³¢ + é«˜æ–¯æ¨¡ç³Š + è¾¹ç¼˜ä¿æŒæ»¤æ³¢
- äº”å®˜å¢å¼º: çœ¼éƒ¨ã€å”‡éƒ¨ç²¾å‡†å¢å¼ºç®—æ³•
- è‰²å½©å’Œè°: æ•´ä½“è‰²å½©å¹³è¡¡è°ƒæ•´
```
**ç®—åŠ›éœ€æ±‚**:
- **å®æ—¶å¤„ç†**: ç”¨æˆ·æœŸæœ›ç§’çº§å“åº”
- **ç®—æ³•å¤æ‚åº¦**: å¤šå±‚æ»¤æ³¢ç®—æ³•è®¡ç®—å¯†é›†
- **å›¾ç‰‡å°ºå¯¸**: æ”¯æŒ4Kå›¾ç‰‡å¤„ç†

#### 3. **æ‰¹é‡å¤„ç†èƒ½åŠ›**
```python
# æ”¯æŒæ‰¹é‡å›¾ç‰‡å¤„ç†
def process_batch_optimized(image_list, batch_size=10):
    # åŒæ—¶å¤„ç†å¤šå¼ å›¾ç‰‡
    # å†…å­˜å ç”¨ = å•å¼ å›¾ç‰‡å†…å­˜ Ã— æ‰¹é‡å¤§å°
```

## ğŸ” è¯¦ç»†ç®—åŠ›æ¶ˆè€—åˆ†æ

### **1. AIç¾é¢œå¤„ç†æ¨¡å—** â­â­â­â­â­ (æé«˜ç®—åŠ›æ¶ˆè€—)

#### ç®—æ³•å¤æ‚åº¦åˆ†æ
```python
# äººè„¸æ£€æµ‹ - Haarçº§è”åˆ†ç±»å™¨
face_cascade = cv2.CascadeClassifier('haarcascade_frontalface_default.xml')
faces = face_cascade.detectMultiScale(gray, 1.1, 4)
# è®¡ç®—å¤æ‚åº¦: O(nÂ²) å…¶ä¸­næ˜¯å›¾ç‰‡åƒç´ æ•°

# å¤šå±‚ç£¨çš®å¤„ç†
def _apply_advanced_skin_smoothing(img, smoothing, face_regions):
    # ç¬¬ä¸€å±‚ï¼šåŒè¾¹æ»¤æ³¢ O(n Ã— dÂ²) dæ˜¯æ»¤æ³¢æ ¸å¤§å°
    smoothed1 = cv2.bilateralFilter(img, d1, sigma_color1, sigma_space1)
    
    # ç¬¬äºŒå±‚ï¼šé«˜æ–¯æ¨¡ç³Š O(n Ã— kÂ²) kæ˜¯é«˜æ–¯æ ¸å¤§å°
    smoothed2 = cv2.GaussianBlur(smoothed1, (kernel_size, kernel_size), 0)
    
    # ç¬¬ä¸‰å±‚ï¼šè¾¹ç¼˜ä¿æŒæ»¤æ³¢ O(n Ã— wÂ²) wæ˜¯çª—å£å¤§å°
    smoothed3 = cv2.edgePreservingFilter(smoothed2, flags=1, sigma_s=50, sigma_r=0.4)
```

#### ç®—åŠ›æ¶ˆè€—è¯¦æƒ…
- **äººè„¸æ£€æµ‹**: 10-50ms (å–å†³äºå›¾ç‰‡å°ºå¯¸)
- **å¤šå±‚ç£¨çš®**: 100-500ms (ç®—æ³•å¤æ‚åº¦é«˜)
- **äº”å®˜å¢å¼º**: 50-200ms (åŒºåŸŸå¤„ç†)
- **è‰²å½©å¤„ç†**: 30-150ms (å…¨å›¾å¤„ç†)

**å•å¼ 4Kå›¾ç‰‡å¤„ç†æ—¶é—´**: 3-8ç§’ (GPU) / 15-40ç§’ (CPU)
**å†…å­˜å ç”¨**: 500MB-2GB (å–å†³äºå›¾ç‰‡å°ºå¯¸)
**CPUä½¿ç”¨ç‡**: 90-100%

### **2. èƒŒæ™¯ç§»é™¤æ¨¡å—** â­â­â­â­â­ (æé«˜ç®—åŠ›æ¶ˆè€—)

#### æ·±åº¦å­¦ä¹ æ¨¡å‹åˆ†æ
```python
# rembg + u2netæ¨¡å‹æ¶æ„
- è¾“å…¥: RGBå›¾åƒ (H Ã— W Ã— 3)
- ç¼–ç å™¨: å¤šå±‚å·ç§¯ + æ³¨æ„åŠ›æœºåˆ¶
- è§£ç å™¨: ä¸Šé‡‡æ · + è·³è·ƒè¿æ¥
- è¾“å‡º: Alphaé€šé“æ©ç  (H Ã— W Ã— 1)
```

#### ç®—åŠ›æ¶ˆè€—è¯¦æƒ…
- **æ¨¡å‹åŠ è½½**: 500MB-1GB GPUæ˜¾å­˜
- **æ¨ç†è®¡ç®—**: 1000-3000ms (GPU) / 8000-20000ms (CPU)
- **å†…å­˜å ç”¨**: 1-4GB (æ¨¡å‹ + å›¾ç‰‡ç¼“å­˜)
- **GPUæ˜¾å­˜**: 2-6GB (æ¨è)

**å•å¼ 4Kå›¾ç‰‡å¤„ç†æ—¶é—´**: 5-10ç§’ (GPU) / 30-90ç§’ (CPU)

### **3. å›¾åƒæ ¼å¼è½¬æ¢æ¨¡å—** â­â­â­ (ä¸­ç­‰ç®—åŠ›æ¶ˆè€—)

#### ç®—æ³•å¤æ‚åº¦
```python
# æ ¼å¼è½¬æ¢ + è´¨é‡ä¼˜åŒ–
- è§£ç : O(n) å…¶ä¸­næ˜¯å›¾ç‰‡åƒç´ æ•°
- ç¼–ç : O(n Ã— log n) å‹ç¼©ç®—æ³•
- è´¨é‡è¯„ä¼°: O(n) åƒç´ çº§åˆ†æ
```

**å•å¼ å›¾ç‰‡å¤„ç†æ—¶é—´**: 1-3ç§’
**å†…å­˜å ç”¨**: 200-800MB
**CPUä½¿ç”¨ç‡**: 60-80%

### **4. é€šä¹‰åƒé—®æ¥å£è°ƒç”¨** â­â­ (ä½ç®—åŠ›æ¶ˆè€—)

#### å®é™…ç”¨é€”
```python
# ä»…ç”¨äºåˆ†æå’Œå»ºè®®ï¼Œä¸å‚ä¸å›¾åƒå¤„ç†
- å›¾åƒå†…å®¹åˆ†æ: è½»é‡çº§JSONå¤„ç†
- æ™ºèƒ½å»ºè®®: å‚æ•°ä¼˜åŒ–å»ºè®®
- é£æ ¼æ¨è: æ»¤é•œå’Œè‰²å½©å»ºè®®
```

**ç®—åŠ›æ¶ˆè€—**: ç½‘ç»œå»¶è¿Ÿ + è½»é‡çº§JSONå¤„ç†
**å¤„ç†æ—¶é—´**: 1-3ç§’ (ä¸»è¦å—ç½‘ç»œå½±å“)

## ğŸ–¥ï¸ ç¡¬ä»¶é…ç½®éœ€æ±‚è¯¦è§£

### **ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›é…ç½®ï¼Ÿ**

#### **GPUçš„å¿…è¦æ€§**
1. **rembgæ¨¡å‹æ¨ç†**: æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨GPUä¸Šæ¯”CPUå¿«10-20å€
2. **OpenCV GPUåŠ é€Ÿ**: CUDAä¼˜åŒ–çš„å›¾åƒå¤„ç†ç®—æ³•
3. **å¹¶è¡Œè®¡ç®—**: åŒæ—¶å¤„ç†å¤šå¼ å›¾ç‰‡

#### **å¤§å†…å­˜çš„å¿…è¦æ€§**
1. **æ¨¡å‹åŠ è½½**: u2netæ¨¡å‹éœ€è¦500MB-1GB
2. **å›¾ç‰‡ç¼“å­˜**: 4Kå›¾ç‰‡å ç”¨å¤§é‡å†…å­˜
3. **æ‰¹é‡å¤„ç†**: å¤šå¼ å›¾ç‰‡åŒæ—¶å¤„ç†

#### **å¤šæ ¸CPUçš„å¿…è¦æ€§**
1. **å¹¶è¡Œå¤„ç†**: å¤šçº¿ç¨‹å›¾åƒå¤„ç†
2. **ä»»åŠ¡è°ƒåº¦**: ç®¡ç†å¤šä¸ªå¤„ç†ä»»åŠ¡
3. **ç³»ç»Ÿç¨³å®šæ€§**: é¿å…å•æ ¸è¿‡è½½

### **å¼€å‘ç¯å¢ƒé…ç½®**

#### æœ€ä½é…ç½® (ä»…æµ‹è¯•åŠŸèƒ½)
- **CPU**: Intel i5-8ä»£ / AMD Ryzen 5 3000ç³»åˆ— (4æ ¸8çº¿ç¨‹)
- **å†…å­˜**: 8GB DDR4
- **å­˜å‚¨**: 256GB SSD
- **GPU**: é›†æˆæ˜¾å¡
- **ç”¨é€”**: åŠŸèƒ½æµ‹è¯•ï¼Œå•å¼ å›¾ç‰‡å¤„ç†

#### æ¨èé…ç½® (å¼€å‘è°ƒè¯•)
- **CPU**: Intel i7-10ä»£ / AMD Ryzen 7 5000ç³»åˆ— (8æ ¸16çº¿ç¨‹)
- **å†…å­˜**: 16GB DDR4
- **å­˜å‚¨**: 512GB NVMe SSD
- **GPU**: NVIDIA GTX 1660 / AMD RX 5600 (6GBæ˜¾å­˜)
- **ç”¨é€”**: å¼€å‘è°ƒè¯•ï¼Œå°æ‰¹é‡å¤„ç†

### **ç”Ÿäº§ç¯å¢ƒé…ç½®**

#### å°è§„æ¨¡éƒ¨ç½² (100ç”¨æˆ·ä»¥ä¸‹)
- **CPU**: Intel Xeon E5-2680 v4 / AMD EPYC 7251 (16æ ¸32çº¿ç¨‹)
- **å†…å­˜**: 32GB DDR4 ECC
- **å­˜å‚¨**: 1TB NVMe SSD + 2TB HDD
- **GPU**: NVIDIA RTX 3060 / AMD RX 6600 (8GBæ˜¾å­˜)
- **ç½‘ç»œ**: 1Gbps

**ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªé…ç½®ï¼Ÿ**
- **16æ ¸CPU**: æ”¯æŒ10-20ä¸ªå¹¶å‘ç”¨æˆ·
- **32GBå†…å­˜**: åŒæ—¶å¤„ç†5-10å¼ 4Kå›¾ç‰‡
- **RTX 3060**: æ”¯æŒrembgæ¨¡å‹ + OpenCV GPUåŠ é€Ÿ

#### ä¸­ç­‰è§„æ¨¡éƒ¨ç½² (100-1000ç”¨æˆ·)
- **CPU**: Intel Xeon Gold 6248 / AMD EPYC 7302 (32æ ¸64çº¿ç¨‹)
- **å†…å­˜**: 64GB DDR4 ECC
- **å­˜å‚¨**: 2TB NVMe SSD + 4TB HDD RAID
- **GPU**: NVIDIA RTX 3080 / AMD RX 6800 (10GBæ˜¾å­˜)
- **ç½‘ç»œ**: 2.5Gbps

**ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªé…ç½®ï¼Ÿ**
- **32æ ¸CPU**: æ”¯æŒ50-100ä¸ªå¹¶å‘ç”¨æˆ·
- **64GBå†…å­˜**: åŒæ—¶å¤„ç†20-40å¼ 4Kå›¾ç‰‡
- **RTX 3080**: æ”¯æŒå¤šæ¨¡å‹å¹¶è¡Œæ¨ç†

#### å¤§è§„æ¨¡éƒ¨ç½² (1000ç”¨æˆ·ä»¥ä¸Š)
- **CPU**: Intel Xeon Platinum 8380 / AMD EPYC 7763 (64æ ¸128çº¿ç¨‹)
- **å†…å­˜**: 128GB+ DDR4 ECC
- **å­˜å‚¨**: 4TB NVMe SSD + 8TB HDD RAID 10
- **GPU**: NVIDIA RTX 4090 / AMD RX 7900 XTX (24GBæ˜¾å­˜)
- **ç½‘ç»œ**: 10Gbps

**ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªé…ç½®ï¼Ÿ**
- **64æ ¸CPU**: æ”¯æŒ200-500ä¸ªå¹¶å‘ç”¨æˆ·
- **128GBå†…å­˜**: åŒæ—¶å¤„ç†50-100å¼ 4Kå›¾ç‰‡
- **RTX 4090**: æ”¯æŒå¤šGPUå¹¶è¡Œ + å¤§æ¨¡å‹

## ğŸ“ˆ æ€§èƒ½åŸºå‡†æµ‹è¯•

### **å•å¼ å›¾ç‰‡å¤„ç†æ€§èƒ½**

| åŠŸèƒ½æ¨¡å— | å›¾ç‰‡å°ºå¯¸ | CPUæ—¶é—´ | GPUæ—¶é—´ | å†…å­˜å ç”¨ | æ¨èé…ç½® |
|---------|---------|---------|---------|----------|----------|
| AIç¾é¢œ | 4K (3840x2160) | 25-40ç§’ | 5-8ç§’ | 800MB-1.5GB | 16æ ¸+RTX3060 |
| èƒŒæ™¯ç§»é™¤ | 4K (3840x2160) | 60-90ç§’ | 8-12ç§’ | 1.5GB-3GB | 32æ ¸+RTX3080 |
| æ ¼å¼è½¬æ¢ | 4K (3840x2160) | 3-5ç§’ | 1-2ç§’ | 400-800MB | 8æ ¸+GTX1660 |
| AIåˆ†æ | 4K (3840x2160) | 8-15ç§’ | 2-5ç§’ | 200-500MB | 8æ ¸+GTX1660 |

### **æ‰¹é‡å¤„ç†æ€§èƒ½**

| æ‰¹é‡å¤§å° | AIç¾é¢œ | èƒŒæ™¯ç§»é™¤ | æ ¼å¼è½¬æ¢ | å†…å­˜å³°å€¼ | æ¨èé…ç½® |
|---------|---------|---------|---------|----------|----------|
| 10å¼ 4K | 8-15åˆ†é’Ÿ | 15-25åˆ†é’Ÿ | 1-2åˆ†é’Ÿ | 4-8GB | 32æ ¸+RTX3080 |
| 50å¼ 4K | 40-80åˆ†é’Ÿ | 80-150åˆ†é’Ÿ | 5-10åˆ†é’Ÿ | 8-16GB | 64æ ¸+RTX4090 |
| 100å¼ 4K | 80-160åˆ†é’Ÿ | 160-300åˆ†é’Ÿ | 10-20åˆ†é’Ÿ | 16-32GB | 128æ ¸+å¤šGPU |

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. **GPUåŠ é€Ÿä¼˜åŒ–**

#### CUDAä¼˜åŒ–
```python
# å®‰è£…GPUç‰ˆæœ¬OpenCV
pip install opencv-python-gpu

# é…ç½®GPUè®¾å¤‡
import cv2
if cv2.cuda.getCudaEnabledDeviceCount() > 0:
    cv2.cuda.setDevice(0)  # ä½¿ç”¨ç¬¬ä¸€å—GPU
    print("GPUåŠ é€Ÿå·²å¯ç”¨")
else:
    print("GPUåŠ é€Ÿä¸å¯ç”¨ï¼Œä½¿ç”¨CPUæ¨¡å¼")
```

#### æ¨¡å‹ä¼˜åŒ–
```python
# ä½¿ç”¨TensorRTä¼˜åŒ–rembgæ¨¡å‹
pip install tensorrt

# æ¨¡å‹é‡åŒ–å‡å°‘æ˜¾å­˜å ç”¨
from onnxruntime.quantization import quantize_dynamic
quantize_dynamic("u2net.onnx", "u2net_quantized.onnx")
```

### 2. **å†…å­˜ä¼˜åŒ–**

#### æ‰¹é‡å¤„ç†ä¼˜åŒ–
```python
def process_batch_optimized(image_list, batch_size=5):
    """ä¼˜åŒ–çš„æ‰¹é‡å¤„ç†ï¼Œé¿å…å†…å­˜æº¢å‡º"""
    results = []
    for i in range(0, len(image_list), batch_size):
        batch = image_list[i:i+batch_size]
        
        # å¤„ç†æ‰¹æ¬¡
        batch_results = process_batch(batch)
        results.extend(batch_results)
        
        # æ¸…ç†å†…å­˜
        gc.collect()
        if torch.cuda.is_available():
            torch.cuda.empty_cache()
        
        # ç­‰å¾…ä¸€å°æ®µæ—¶é—´è®©ç³»ç»Ÿç¨³å®š
        time.sleep(0.1)
    
    return results
```

#### å›¾ç‰‡å°ºå¯¸ä¼˜åŒ–
```python
def optimize_image_size(image_path, max_size=(1920, 1080)):
    """ä¼˜åŒ–å›¾ç‰‡å°ºå¯¸ï¼Œå‡å°‘å†…å­˜å ç”¨"""
    img = cv2.imread(image_path)
    height, width = img.shape[:2]
    
    if height > max_size[1] or width > max_size[0]:
        # ç­‰æ¯”ä¾‹ç¼©æ”¾
        scale = min(max_size[0]/width, max_size[1]/height)
        new_width = int(width * scale)
        new_height = int(height * scale)
        img = cv2.resize(img, (new_width, new_height))
        
        # ä¿å­˜ä¼˜åŒ–åçš„å›¾ç‰‡
        cv2.imwrite(image_path, img)
        print(f"å›¾ç‰‡å·²ä¼˜åŒ–: {width}x{height} -> {new_width}x{new_height}")
```

### 3. **å¼‚æ­¥å¤„ç†ä¼˜åŒ–**

#### Celeryä»»åŠ¡é˜Ÿåˆ—
```python
from celery import Celery
import os

# é…ç½®Celery
app = Celery('image_processing')
app.conf.update(
    broker_url='redis://localhost:6379/0',
    result_backend='redis://localhost:6379/0',
    task_serializer='json',
    accept_content=['json'],
    result_serializer='json',
    timezone='Asia/Shanghai',
    enable_utc=True,
)

@app.task(bind=True)
def process_image_async(self, image_path, params):
    """å¼‚æ­¥å›¾åƒå¤„ç†"""
    try:
        # æ›´æ–°ä»»åŠ¡çŠ¶æ€
        self.update_state(state='PROGRESS', meta={'current': 0, 'total': 100})
        
        # å¤„ç†å›¾ç‰‡
        result = ImageProcessingService.apply_beauty(image_path, params)
        
        # æ›´æ–°å®ŒæˆçŠ¶æ€
        self.update_state(state='SUCCESS', meta={'current': 100, 'total': 100})
        return result
        
    except Exception as e:
        # æ›´æ–°å¤±è´¥çŠ¶æ€
        self.update_state(state='FAILURE', meta={'error': str(e)})
        raise e
```

## ğŸ”§ éƒ¨ç½²é…ç½®å»ºè®®

### **Dockeréƒ¨ç½²ä¼˜åŒ–**

```dockerfile
# ä½¿ç”¨GPUæ”¯æŒçš„åŸºç¡€é•œåƒ
FROM nvidia/cuda:11.8-devel-ubuntu20.04

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    libgl1-mesa-glx \
    libglib2.0-0 \
    libsm6 \
    libxext6 \
    libxrender-dev \
    libgomp1 \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£…GPUç‰ˆæœ¬çš„OpenCV
RUN pip install opencv-python-gpu

# é…ç½®GPUç¯å¢ƒå˜é‡
ENV NVIDIA_VISIBLE_DEVICES all
ENV NVIDIA_DRIVER_CAPABILITIES compute,utility

# å®‰è£…Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºä¸Šä¼ ç›®å½•
RUN mkdir -p static/uploads

EXPOSE 5002

# å¯åŠ¨å‘½ä»¤
CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5002", "run:app"]
```

### **Kuberneteséƒ¨ç½²ä¼˜åŒ–**

```yaml
# GPUèµ„æºè¯·æ±‚
apiVersion: v1
kind: Pod
metadata:
  name: ai-image-platform
spec:
  containers:
  - name: ai-image-platform
    image: your-registry/ai-image-platform:latest
    resources:
      limits:
        nvidia.com/gpu: 1
        memory: "8Gi"
        cpu: "4"
      requests:
        nvidia.com/gpu: 1
        memory: "4Gi"
        cpu: "2"
    env:
    - name: NVIDIA_VISIBLE_DEVICES
      value: "all"
    - name: NVIDIA_DRIVER_CAPABILITIES
      value: "compute,utility"
```

### **è´Ÿè½½å‡è¡¡é…ç½®**

```nginx
# Nginxè´Ÿè½½å‡è¡¡é…ç½®
upstream backend {
    # ä¸»æœåŠ¡å™¨ (GPU)
    server 127.0.0.1:5002 weight=3;
    
    # è¾…åŠ©æœåŠ¡å™¨ (CPU)
    server 127.0.0.1:5003 weight=2;
    server 127.0.0.1:5004 weight=1;
}

server {
    listen 80;
    server_name your-domain.com;
    
    # é™æ€æ–‡ä»¶æœåŠ¡
    location / {
        root /var/www/ai_image_platform/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # APIä»£ç†
    location /api/ {
        proxy_pass http://backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # å¢åŠ è¶…æ—¶æ—¶é—´
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }
}
```

## ğŸ“Š æˆæœ¬æ•ˆç›Šåˆ†æ

### **ç¡¬ä»¶æŠ•èµ„å›æŠ¥**

| é…ç½®ç­‰çº§ | ç¡¬ä»¶æˆæœ¬ | å¤„ç†èƒ½åŠ› | ç”¨æˆ·æ”¯æŒ | ROIå‘¨æœŸ | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|----------|---------|----------|
| åŸºç¡€é…ç½® | Â¥8,000-15,000 | 50ç”¨æˆ·/å°æ—¶ | 100ç”¨æˆ· | 8-15ä¸ªæœˆ | å°å‹å·¥ä½œå®¤ |
| æ ‡å‡†é…ç½® | Â¥25,000-45,000 | 200ç”¨æˆ·/å°æ—¶ | 500ç”¨æˆ· | 12-20ä¸ªæœˆ | ä¸­å‹ä¼ä¸š |
| é«˜çº§é…ç½® | Â¥80,000-150,000 | 500ç”¨æˆ·/å°æ—¶ | 1000ç”¨æˆ· | 18-30ä¸ªæœˆ | å¤§å‹å¹³å° |

### **äº‘æœåŠ¡æˆæœ¬å¯¹æ¯”**

| äº‘æœåŠ¡å•† | å®ä¾‹ç±»å‹ | GPUé…ç½® | æœˆè´¹ç”¨ | å¤„ç†èƒ½åŠ› | æ¨èæŒ‡æ•° |
|---------|---------|---------|--------|----------|----------|
| é˜¿é‡Œäº‘ | ecs.gn7i-c16g1.4xlarge | V100 16GB | Â¥3,500 | 200ç”¨æˆ·/å°æ—¶ | â­â­â­â­ |
| è…¾è®¯äº‘ | GN7.2XLARGE32 | V100 16GB | Â¥3,200 | 200ç”¨æˆ·/å°æ—¶ | â­â­â­â­ |
| AWS | p3.2xlarge | V100 16GB | Â¥4,800 | 250ç”¨æˆ·/å°æ—¶ | â­â­â­â­â­ |

## ğŸ¯ æ€»ç»“ä¸å»ºè®®

### **å…³é”®å‘ç°**

1. **ç®—åŠ›éœ€æ±‚ä¸»è¦æ¥è‡ªæœ¬åœ°è®¡ç®—**ï¼Œä¸æ˜¯å¤–éƒ¨APIè°ƒç”¨
2. **rembgæ·±åº¦å­¦ä¹ æ¨¡å‹æ˜¯æœ€å¤§ç®—åŠ›æ¶ˆè€—ç‚¹**ï¼Œéœ€è¦GPUåŠ é€Ÿ
3. **OpenCVå›¾åƒå¤„ç†ç®—æ³•å¤æ‚åº¦é«˜**ï¼Œéœ€è¦å¤šæ ¸CPU
4. **å†…å­˜ç®¡ç†å¯¹æ‰¹é‡å¤„ç†æ€§èƒ½è‡³å…³é‡è¦**

### **ä¸ºä»€ä¹ˆéœ€è¦å¤§ç®—åŠ›ï¼Ÿ**

1. **æ·±åº¦å­¦ä¹ æ¨¡å‹æ¨ç†**: u2netæ¨¡å‹éœ€è¦å¤§é‡çŸ©é˜µè¿ç®—
2. **å®æ—¶å›¾åƒå¤„ç†**: ç”¨æˆ·æœŸæœ›ç§’çº§å“åº”ï¼Œéœ€è¦å¹¶è¡Œè®¡ç®—
3. **æ‰¹é‡å¤„ç†èƒ½åŠ›**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨
4. **4Kå›¾ç‰‡æ”¯æŒ**: é«˜åˆ†è¾¨ç‡å›¾ç‰‡å¤„ç†éœ€è¦æ›´å¤šèµ„æº

### **éƒ¨ç½²å»ºè®®**

1. **å°è§„æ¨¡éƒ¨ç½²**: äº‘æœåŠ¡ + GPUå®ä¾‹ï¼ŒæŒ‰éœ€æ‰©å±•
2. **ä¸­ç­‰è§„æ¨¡**: è‡ªå»ºæœåŠ¡å™¨ + RTX 3080/4080
3. **å¤§è§„æ¨¡éƒ¨ç½²**: åˆ†å¸ƒå¼æ¶æ„ + å¤šGPUé›†ç¾¤

### **æŠ€æœ¯è·¯çº¿å›¾**

- **çŸ­æœŸ (3ä¸ªæœˆ)**: GPUåŠ é€Ÿ + å†…å­˜ä¼˜åŒ–
- **ä¸­æœŸ (6ä¸ªæœˆ)**: å¼‚æ­¥å¤„ç† + ç¼“å­˜ç³»ç»Ÿ
- **é•¿æœŸ (12ä¸ªæœˆ)**: åˆ†å¸ƒå¼æ¶æ„ + æ¨¡å‹ä¼˜åŒ–

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025å¹´8æœˆ13æ—¥  
**æŠ€æœ¯ç‰ˆæœ¬**: AIå›¾åƒå¤„ç†å¹³å° v2.0  
**åˆ†æèŒƒå›´**: æœ¬åœ°è®¡ç®—ç®—åŠ›éœ€æ±‚ + ç¡¬ä»¶é…ç½®å»ºè®®  
**å…³é”®ä¿®æ­£**: ç®—åŠ›æ¶ˆè€—ä¸»è¦æ¥è‡ªæœ¬åœ°OpenCV + rembgï¼Œéé€šä¹‰åƒé—®API
