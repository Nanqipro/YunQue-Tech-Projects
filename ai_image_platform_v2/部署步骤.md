# AI图像处理平台部署指南

本文档提供了AI图像处理平台的完整部署步骤，包括后端Flask服务和前端Web应用的启动。

## 系统要求

- Python 3.8+
- Node.js 14+
- Git
- 至少4GB可用内存
- 至少2GB可用磁盘空间

## 部署步骤

### 1. 安装Conda

#### Linux/macOS系统

```bash
# 下载Miniconda安装脚本
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh

# 运行安装脚本
bash Miniconda3-latest-Linux-x86_64.sh

# 重新加载shell配置
source ~/.bashrc

# 验证安装
conda --version
```

#### Windows系统

1. 访问 [Miniconda官网](https://docs.conda.io/en/latest/miniconda.html)
2. 下载适合Windows的安装包
3. 运行安装程序，按照向导完成安装
4. 打开Anaconda Prompt验证安装：
   ```cmd
   conda --version
   ```

### 2. 创建虚拟环境

```bash
# 创建名为ai_platform的Python虚拟环境
conda create -n ai_platform python=3.12.3

# 验证环境创建成功
conda env list
```

### 3. 激活虚拟环境

```bash
# 激活虚拟环境
conda activate ai_platform

# 验证环境已激活（命令行前缀应显示(ai_platform)）
which python  # Linux/macOS
where python  # Windows
```

### 4. 克隆项目代码

```bash
# 克隆项目仓库
git clone <项目仓库地址>
cd ai_image_platform_v2
```

### 5. 启动后端服务

#### Linux系统

```bash
# 确保脚本有执行权限
chmod +x backend_start.sh

# 执行后端启动脚本
bash backend_start.sh
```

#### Windows系统

```cmd
# 执行后端启动脚本
backend_start.bat
```

**后端启动脚本功能：**
- 自动安装Python依赖包
- 初始化数据库
- 启动Flask开发服务器
- 默认运行在 `http://localhost:5000`

### 6. 启动前端服务

#### Linux系统

```bash
# 确保脚本有执行权限
chmod +x frontend_start.sh

# 执行前端启动脚本
bash frontend_start.sh
```

#### Windows系统

```cmd
# 执行前端启动脚本
frontend_start.bat
```

**前端启动脚本功能：**
- 自动安装Node.js依赖包
- 构建前端资源
- 启动开发服务器
- 默认运行在 `http://localhost:3000`

## 验证部署

### 1. 检查服务状态

- **后端服务**：访问 `http://localhost:5000/health` 应返回健康检查信息
- **前端服务**：访问 `http://localhost:3000` 应显示平台主页

### 2. 功能测试

1. 在浏览器中打开 `http://localhost:3000`
2. 注册新用户账号
3. 登录系统
4. 上传测试图片
5. 尝试使用AI图像处理功能

## 常见问题解决

### 端口冲突

如果默认端口被占用，可以修改配置：

- **后端端口**：修改 `backend/config/config.py` 中的端口设置
- **前端端口**：修改 `frontend/webpack.config.js` 中的devServer配置

### 依赖安装失败

```bash
# 清理conda缓存
conda clean --all

# 更新conda
conda update conda

# 重新创建环境
conda remove -n ai_platform --all
conda create -n ai_platform python=3.9
```

### 数据库初始化失败

```bash
# 进入后端目录
cd backend

# 手动初始化数据库
python -c "from app import create_app, db; app = create_app(); app.app_context().push(); db.create_all()"
```

## 生产环境部署

对于生产环境部署，建议：

1. 使用 `docker-compose.yml` 进行容器化部署
2. 配置反向代理（Nginx）
3. 使用HTTPS证书
4. 配置环境变量和密钥管理
5. 设置日志记录和监控

详细的生产环境部署指南请参考 `PRODUCTION_DEPLOYMENT.md`。

## 技术支持

如遇到部署问题，请：

1. 检查系统要求是否满足
2. 查看终端错误日志
3. 参考项目README文档
4. 提交Issue到项目仓库

---

**注意**：首次启动可能需要较长时间来下载和安装依赖包，请耐心等待。